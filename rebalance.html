<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <meta name="author" content="Triet Lieu">
        <title>Pokémon Type Rebalancing</title>
        <style>
            html {
                font-size: 15px;
                font-family: "Helvetica", "Arial Narrow", sans-serif;
                line-height: 1.5;
                color: #404040;
            }

            body {
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            body > * {
                margin-bottom: 25px;
            }

            #title {
                font-style: italic;
                color: #F8D030;
            }
            
            #btn-container {
                display: flex;
                align-items: center;
                margin-bottom: 35px;
            }

            #btn-container > button {
                font-size: 14px;
                letter-spacing: .75px;
                padding: 10px;
                width: 100px;
                margin: auto 80px;
                border: none;
                background-color: #007bff;
                color: white;
                cursor: pointer;
            }

            #changes-label {
                padding: 10px;
                font-size: 16px;
                letter-spacing: 1px; 
                background-color: #F85888;
                color: white;
            }

            /* Input to handleUpload, but is "covered" by button */
            #file-upload {
                display: none;
            }

            table {
                margin: 0 auto 30px;
                /* No double border shared among rows*/
                border-collapse: collapse;
                border-spacing: 0;
                padding: 0;
            }

            table th, table td {
                border: 1px solid #ECECEC;
                font-weight: normal;
                padding: 0;
            }

            #chart-body {
                cursor: pointer;
            }

            /* Headings (ATTACK, DEFENCE, TYPE, STAT) */
            .tiny-text {
                font-size: 9px;
            }

            /* Icon containing type name. Wrapped by <th> */
            a {
                display: inline-block;
                text-decoration: none;
                transition: color 0.2s, background-color 0.2s;
                background: #CCCCCC;
                background-image: linear-gradient(#DDDDDD, #BBBBBB);
                width: 32px;
                border: 1px solid #AAAAAA;
                border-radius: 2px;
                color: #FFFFFF;
                font-size: 10px;
                height: 32px;   /* If line-height == height, align text vertically*/
                line-height: 32px;
                text-align: center;
                text-shadow: 1px 1px 1px #333333;
                text-transform: uppercase;
            }

            /* Full-sized (ie ATK type, stat type) header */
            .icon-fu {
                background: #BBBBBB;
                border: 1px solid #AAAAAA;
                border-radius: 2px;
                color: #FFFFFF;
                font-size: 10px;
                text-align: center;
                text-shadow: 1px 1px 1px #333333;
                text-transform: uppercase;
                height: 32px;
                line-height: 32px;
                width: 54px;
            }

            .icon-fu:first-child {
                margin-left: 0;
            }

            /* For eg <td id="Ice → Ice">½</td> (sole effective dmg cell)*/
            [class^='dmg-perc-'] {
                color: #DDDD66;
                font-size: 13px;
                height: 32px;
                line-height: 32px;
                text-align: center;
                width: 32px;
            }

            /* Beige color on types that are balanced in ATK, DEF stats*/
            .dmg-perc-N {
                background-color: #FFFDD0;
            }

            /* Color-code each dmg % (100% gets white default) */
            .dmg-perc-0 {
                background-color: #2E3436;
            }

            .dmg-perc-50 {
                background-color: #A40000;
                font-size: 16px;    /* To magnify ½ */
            }

            .dmg-perc-200 {
                background-color: #4E9A06;
            }

            /* Enlargen text in stat cells */
            [id^='ATK'], [id^='DEF'], [id^='Total'] {
                font-size: 15px;
            }

            [id$="STD"] {
                font-weight: bold;
            }

            /* Use each type color in 3 contexts: as ATK type, DEF type, stat header */
            .type-normal {
                background-image: linear-gradient(#A8A878, #8A8A59);
                border-color: #79794E;
            }

            .type-fire {
                background-image: linear-gradient(#F08030, #DD6610);
                border-color: #B4530D;
            }

            .type-water {
                background-image: linear-gradient(#6890F0, #386CEB);
                border-color: #1753E3;
            }

            .type-electric {
                background-image: linear-gradient(#F8D030, #F0C108);
                border-color: #C19B07;
            }

            .type-grass {
                background-image: linear-gradient(#78C750, #5CA935);
                border-color: #4A892B;
            }

            .type-ice {
                background-image: linear-gradient(#98D8D8, #69C6C6);
                border-color: #45B6B6;
            }

            .type-fighting {
                background-image: linear-gradient(#C03028, #9D2721);
                border-color: #82211B;
            }

            .type-poison {
                background-image: linear-gradient(#A040A0, #803380);
                border-color: #662966;
            }

            .type-ground {
                background-image: linear-gradient(#E0C068, #D4A82F);
                border-color: #AA8623;
            }

            .type-flying {
                background: #A890F0;
                background-image: linear-gradient(#A890F0, #9180C4);
                border-color: #7762B6;
            }

            .type-psychic {
                background-image: linear-gradient(#F85888, #F61C5D);
                border-color: #D60945;
            }

            .type-bug {
                background-image: linear-gradient(#A8B820, #8D9A1B);
                border-color: #616B13;
            }

            .type-rock {
                background-image: linear-gradient(#B8A038, #93802D);
                border-color: #746523;
            }

            .type-ghost {
                background-image: linear-gradient(#705898, #554374);
                border-color: #413359;
            }

            .type-dragon {
                background-image: linear-gradient(#7038F8, #4C08EF);
                border-color: #3D07C0;
            }

            .type-dark {
                background-image: linear-gradient(#705848, #513F34);
                border-color: #362A23;
            }

            .type-steel {
                background-image: linear-gradient(#B8B8D0, #9797BA);
                border-color: #7A7AA7;
            }

            .type-fairy {
                background-image: linear-gradient(#E898E8, #DE6EDE);
                border-color: #D547D5;
            }
        </style>
    </head>
    <body>
        <h2 id="title">Pokémon Type Rebalancing</h2>

        <div id="btn-container">
            <input  id="file-upload" type="file" accept=".csv">
            <button id="btn-upload">Upload</button>
            <button id="btn-clear">Clear All</button>
            <button id="btn-download">Download</button>
        </div>

        <table>
            <thead>
                <tr id="chart-head">
                    <th class="tiny-text">DEFENCE&nbsp;&#8594;<br/>ATTACK&nbsp;&#8628;</th>
                    <th>
                        <a class="type-normal">Nor</a>
                    </th>
                    <th>
                        <a class="type-fire">Fir</a>
                    </th>
                    <th>
                        <a class="type-water">Wat</a>
                    </th>
                    <th>
                        <a class="type-electric">Ele</a>
                    </th>
                    <th>
                        <a class="type-grass">Gra</a>
                    </th>
                    <th>
                        <a class="type-ice">Ice</a>
                    </th>
                    <th>
                        <a class="type-fighting">Fig</a>
                    </th>
                    <th>
                        <a class="type-poison">Poi</a>
                    </th>
                    <th>
                        <a class="type-ground">Gro</a>
                    </th>
                    <th>
                        <a class="type-flying">Fly</a>
                    </th>
                    <th>
                        <a class="type-psychic">Psy</a>
                    </th>
                    <th>
                        <a class="type-bug">Bug</a>
                    </th>
                    <th>
                        <a class="type-rock">Roc</a>
                    </th>
                    <th>
                        <a class="type-ghost">Gho</a>
                    </th>
                    <th>
                        <a class="type-dragon">Dra</a>
                    </th>
                    <th>
                        <a class="type-dark">Dar</a>
                    </th>
                    <th>
                        <a class="type-steel">Ste</a>
                    </th>
                    <th>
                        <a class="type-fairy">Fai</a>
                    </th>
                </tr>
            </thead>
            <tbody id="chart-body">
                <tr id="Normal">
                    <th>
                        <a class="icon-fu type-normal">Normal</a>
                    </th>
                    <td id="Normal → Normal"   class="dmg-perc-"></td>
                    <td id="Normal → Fire"     class="dmg-perc-"></td>
                    <td id="Normal → Water"    class="dmg-perc-"></td>
                    <td id="Normal → Electric" class="dmg-perc-"></td>
                    <td id="Normal → Grass"    class="dmg-perc-"></td>
                    <td id="Normal → Ice"      class="dmg-perc-"></td>
                    <td id="Normal → Fighting" class="dmg-perc-"></td>
                    <td id="Normal → Poison"   class="dmg-perc-"></td>
                    <td id="Normal → Ground"   class="dmg-perc-"></td>
                    <td id="Normal → Flying"   class="dmg-perc-"></td>
                    <td id="Normal → Psychic"  class="dmg-perc-"></td>
                    <td id="Normal → Bug"      class="dmg-perc-"></td>
                    <td id="Normal → Rock"     class="dmg-perc-50">½</td>
                    <td id="Normal → Ghost"    class="dmg-perc-0">0</td>
                    <td id="Normal → Dragon"   class="dmg-perc-"></td>
                    <td id="Normal → Dark"     class="dmg-perc-"></td>
                    <td id="Normal → Steel"    class="dmg-perc-50">½</td>
                    <td id="Normal → Fairy"    class="dmg-perc-"></td>
                </tr>
                <tr id="Fire">
                    <th>
                        <a class="icon-fu type-fire">Fire</a>
                    </th>
                    <td id="Fire → Normal"   class="dmg-perc-"></td>
                    <td id="Fire → Fire"     class="dmg-perc-50">½</td>
                    <td id="Fire → Water"    class="dmg-perc-50">½</td>
                    <td id="Fire → Electric" class="dmg-perc-"></td>
                    <td id="Fire → Grass"    class="dmg-perc-200">2</td>
                    <td id="Fire → Ice"      class="dmg-perc-200">2</td>
                    <td id="Fire → Fighting" class="dmg-perc-"></td>
                    <td id="Fire → Poison"   class="dmg-perc-"></td>
                    <td id="Fire → Ground"   class="dmg-perc-"></td>
                    <td id="Fire → Flying"   class="dmg-perc-"></td>
                    <td id="Fire → Psychic"  class="dmg-perc-"></td>
                    <td id="Fire → Bug"      class="dmg-perc-200">2</td>
                    <td id="Fire → Rock"     class="dmg-perc-50">½</td>
                    <td id="Fire → Ghost"    class="dmg-perc-"></td>
                    <td id="Fire → Dragon"   class="dmg-perc-50">½</td>
                    <td id="Fire → Dark"     class="dmg-perc-"></td>
                    <td id="Fire → Steel"    class="dmg-perc-200">2</td>
                    <td id="Fire → Fairy"    class="dmg-perc-"></td>
                </tr>
                <tr id="Water">
                    <th>
                        <a class="icon-fu type-water">Water</a>
                    </th>
                    <td id="Water → Normal"   class="dmg-perc-"></td>
                    <td id="Water → Fire"     class="dmg-perc-200">2</td>
                    <td id="Water → Water"    class="dmg-perc-50">½</td>
                    <td id="Water → Electric" class="dmg-perc-"></td>
                    <td id="Water → Grass"    class="dmg-perc-50">½</td>
                    <td id="Water → Ice"      class="dmg-perc-"></td>
                    <td id="Water → Fighting" class="dmg-perc-"></td>
                    <td id="Water → Poison"   class="dmg-perc-"></td>
                    <td id="Water → Ground"   class="dmg-perc-200">2</td>
                    <td id="Water → Flying"   class="dmg-perc-"></td>
                    <td id="Water → Psychic"  class="dmg-perc-"></td>
                    <td id="Water → Bug"      class="dmg-perc-"></td>
                    <td id="Water → Rock"     class="dmg-perc-200">2</td>
                    <td id="Water → Ghost"    class="dmg-perc-"></td>
                    <td id="Water → Dragon"   class="dmg-perc-50">½</td>
                    <td id="Water → Dark"     class="dmg-perc-"></td>
                    <td id="Water → Steel"    class="dmg-perc-"></td>
                    <td id="Water → Fairy"    class="dmg-perc-"></td>
                </tr>
                <tr id="Electric">
                    <th>
                        <a class="icon-fu type-electric">Electric</a>
                    </th>
                    <td id="Electric → Normal"   class="dmg-perc-"></td>
                    <td id="Electric → Fire"     class="dmg-perc-"></td>
                    <td id="Electric → Water"    class="dmg-perc-200">2</td>
                    <td id="Electric → Electric" class="dmg-perc-50">½</td>
                    <td id="Electric → Grass"    class="dmg-perc-50">½</td>
                    <td id="Electric → Ice"      class="dmg-perc-"></td>
                    <td id="Electric → Fighting" class="dmg-perc-"></td>
                    <td id="Electric → Poison"   class="dmg-perc-"></td>
                    <td id="Electric → Ground"   class="dmg-perc-0">0</td>
                    <td id="Electric → Flying"   class="dmg-perc-200">2</td>
                    <td id="Electric → Psychic"  class="dmg-perc-"></td>
                    <td id="Electric → Bug"      class="dmg-perc-"></td>
                    <td id="Electric → Rock"     class="dmg-perc-"></td>
                    <td id="Electric → Ghost"    class="dmg-perc-"></td>
                    <td id="Electric → Dragon"   class="dmg-perc-50">½</td>
                    <td id="Electric → Dark"     class="dmg-perc-"></td>
                    <td id="Electric → Steel"    class="dmg-perc-"></td>
                    <td id="Electric → Fairy"    class="dmg-perc-"></td>
                </tr>
                <tr id="Grass">
                    <th>
                        <a class="icon-fu type-grass">Grass</a>
                    </th>
                    <td id="Grass → Normal"   class="dmg-perc-"></td>
                    <td id="Grass → Fire"     class="dmg-perc-50">½</td>
                    <td id="Grass → Water"    class="dmg-perc-200">2</td>
                    <td id="Grass → Electric" class="dmg-perc-"></td>
                    <td id="Grass → Grass"    class="dmg-perc-50">½</td>
                    <td id="Grass → Ice"      class="dmg-perc-"></td>
                    <td id="Grass → Fighting" class="dmg-perc-"></td>
                    <td id="Grass → Poison"   class="dmg-perc-50">½</td>
                    <td id="Grass → Ground"   class="dmg-perc-200">2</td>
                    <td id="Grass → Flying"   class="dmg-perc-50">½</td>
                    <td id="Grass → Psychic"  class="dmg-perc-"></td>
                    <td id="Grass → Bug"      class="dmg-perc-50">½</td>
                    <td id="Grass → Rock"     class="dmg-perc-200">2</td>
                    <td id="Grass → Ghost"    class="dmg-perc-"></td>
                    <td id="Grass → Dragon"   class="dmg-perc-50">½</td>
                    <td id="Grass → Dark"     class="dmg-perc-"></td>
                    <td id="Grass → Steel"    class="dmg-perc-50">½</td>
                    <td id="Grass → Fairy"    class="dmg-perc-"></td>
                </tr>
                <tr id="Ice">
                    <th>
                        <a class="icon-fu type-ice">Ice</a>
                    </th>
                    <td id="Ice → Normal"   class="dmg-perc-"></td>
                    <td id="Ice → Fire"     class="dmg-perc-50">½</td>
                    <td id="Ice → Water"    class="dmg-perc-50">½</td>
                    <td id="Ice → Electric" class="dmg-perc-"></td>
                    <td id="Ice → Grass"    class="dmg-perc-200">2</td>
                    <td id="Ice → Ice"      class="dmg-perc-50">½</td>
                    <td id="Ice → Fighting" class="dmg-perc-"></td>
                    <td id="Ice → Poison"   class="dmg-perc-"></td>
                    <td id="Ice → Ground"   class="dmg-perc-200">2</td>
                    <td id="Ice → Flying"   class="dmg-perc-200">2</td>
                    <td id="Ice → Psychic"  class="dmg-perc-"></td>
                    <td id="Ice → Bug"      class="dmg-perc-"></td>
                    <td id="Ice → Rock"     class="dmg-perc-"></td>
                    <td id="Ice → Ghost"    class="dmg-perc-"></td>
                    <td id="Ice → Dragon"   class="dmg-perc-200">2</td>
                    <td id="Ice → Dark"     class="dmg-perc-"></td>
                    <td id="Ice → Steel"    class="dmg-perc-50">½</td>
                    <td id="Ice → Fairy"    class="dmg-perc-"></td>
                </tr>
                <tr id="Fighting">
                    <th>
                        <a class="icon-fu type-fighting">Fighting</a>
                    </th>
                    <td id="Fighting → Normal"   class="dmg-perc-200">2</td>
                    <td id="Fighting → Fire"     class="dmg-perc-"></td>
                    <td id="Fighting → Water"    class="dmg-perc-"></td>
                    <td id="Fighting → Electric" class="dmg-perc-"></td>
                    <td id="Fighting → Grass"    class="dmg-perc-"></td>
                    <td id="Fighting → Ice"      class="dmg-perc-200">2</td>
                    <td id="Fighting → Fighting" class="dmg-perc-"></td>
                    <td id="Fighting → Poison"   class="dmg-perc-50">½</td>
                    <td id="Fighting → Ground"   class="dmg-perc-"></td>
                    <td id="Fighting → Flying"   class="dmg-perc-50">½</td>
                    <td id="Fighting → Psychic"  class="dmg-perc-50">½</td>
                    <td id="Fighting → Bug"      class="dmg-perc-50">½</td>
                    <td id="Fighting → Rock"     class="dmg-perc-200">2</td>
                    <td id="Fighting → Ghost"    class="dmg-perc-0">0</td>
                    <td id="Fighting → Dragon"   class="dmg-perc-"></td>
                    <td id="Fighting → Dark"     class="dmg-perc-200">2</td>
                    <td id="Fighting → Steel"    class="dmg-perc-200">2</td>
                    <td id="Fighting → Fairy"    class="dmg-perc-50">½</td>
                </tr>
                <tr id="Poison">
                    <th>
                        <a class="icon-fu type-poison">Poison</a>
                    </th>
                    <td id="Poison → Normal"   class="dmg-perc-"></td>
                    <td id="Poison → Fire"     class="dmg-perc-"></td>
                    <td id="Poison → Water"    class="dmg-perc-"></td>
                    <td id="Poison → Electric" class="dmg-perc-"></td>
                    <td id="Poison → Grass"    class="dmg-perc-200">2</td>
                    <td id="Poison → Ice"      class="dmg-perc-"></td>
                    <td id="Poison → Fighting" class="dmg-perc-"></td>
                    <td id="Poison → Poison"   class="dmg-perc-50">½</td>
                    <td id="Poison → Ground"   class="dmg-perc-50">½</td>
                    <td id="Poison → Flying"   class="dmg-perc-"></td>
                    <td id="Poison → Psychic"  class="dmg-perc-"></td>
                    <td id="Poison → Bug"      class="dmg-perc-"></td>
                    <td id="Poison → Rock"     class="dmg-perc-50">½</td>
                    <td id="Poison → Ghost"    class="dmg-perc-50">½</td>
                    <td id="Poison → Dragon"   class="dmg-perc-"></td>
                    <td id="Poison → Dark"     class="dmg-perc-"></td>
                    <td id="Poison → Steel"    class="dmg-perc-0">0</td>
                    <td id="Poison → Fairy"    class="dmg-perc-200">2</td>
                </tr>
                <tr id="Ground">
                    <th>
                        <a class="icon-fu type-ground">Ground</a>
                    </th>
                    <td id="Ground → Normal"   class="dmg-perc-"></td>
                    <td id="Ground → Fire"     class="dmg-perc-200">2</td>
                    <td id="Ground → Water"    class="dmg-perc-"></td>
                    <td id="Ground → Electric" class="dmg-perc-200">2</td>
                    <td id="Ground → Grass"    class="dmg-perc-50">½</td>
                    <td id="Ground → Ice"      class="dmg-perc-"></td>
                    <td id="Ground → Fighting" class="dmg-perc-"></td>
                    <td id="Ground → Poison"   class="dmg-perc-200">2</td>
                    <td id="Ground → Ground"   class="dmg-perc-"></td>
                    <td id="Ground → Flying"   class="dmg-perc-0">0</td>
                    <td id="Ground → Psychic"  class="dmg-perc-"></td>
                    <td id="Ground → Bug"      class="dmg-perc-50">½</td>
                    <td id="Ground → Rock"     class="dmg-perc-200">2</td>
                    <td id="Ground → Ghost"    class="dmg-perc-"></td>
                    <td id="Ground → Dragon"   class="dmg-perc-"></td>
                    <td id="Ground → Dark"     class="dmg-perc-"></td>
                    <td id="Ground → Steel"    class="dmg-perc-200">2</td>
                    <td id="Ground → Fairy"    class="dmg-perc-"></td>
                </tr>
                <tr id="Flying">
                    <th>
                        <a class="icon-fu type-flying">Flying</a>
                    </th>
                    <td id="Flying → Normal"   class="dmg-perc-"></td>
                    <td id="Flying → Fire"     class="dmg-perc-"></td>
                    <td id="Flying → Water"    class="dmg-perc-"></td>
                    <td id="Flying → Electric" class="dmg-perc-50">½</td>
                    <td id="Flying → Grass"    class="dmg-perc-200">2</td>
                    <td id="Flying → Ice"      class="dmg-perc-"></td>
                    <td id="Flying → Fighting" class="dmg-perc-200">2</td>
                    <td id="Flying → Poison"   class="dmg-perc-"></td>
                    <td id="Flying → Ground"   class="dmg-perc-"></td>
                    <td id="Flying → Flying"   class="dmg-perc-"></td>
                    <td id="Flying → Psychic"  class="dmg-perc-"></td>
                    <td id="Flying → Bug"      class="dmg-perc-200">2</td>
                    <td id="Flying → Rock"     class="dmg-perc-50">½</td>
                    <td id="Flying → Ghost"    class="dmg-perc-"></td>
                    <td id="Flying → Dragon"   class="dmg-perc-"></td>
                    <td id="Flying → Dark"     class="dmg-perc-"></td>
                    <td id="Flying → Steel"    class="dmg-perc-50">½</td>
                    <td id="Flying → Fairy"    class="dmg-perc-"></td>
                </tr>
                <tr id="Psychic">
                    <th>
                        <a class="icon-fu type-psychic">Psychic</a>
                    </th>
                    <td id="Psychic → Normal"   class="dmg-perc-"></td>
                    <td id="Psychic → Fire"     class="dmg-perc-"></td>
                    <td id="Psychic → Water"    class="dmg-perc-"></td>
                    <td id="Psychic → Electric" class="dmg-perc-"></td>
                    <td id="Psychic → Grass"    class="dmg-perc-"></td>
                    <td id="Psychic → Ice"      class="dmg-perc-"></td>
                    <td id="Psychic → Fighting" class="dmg-perc-200">2</td>
                    <td id="Psychic → Poison"   class="dmg-perc-200">2</td>
                    <td id="Psychic → Ground"   class="dmg-perc-"></td>
                    <td id="Psychic → Flying"   class="dmg-perc-"></td>
                    <td id="Psychic → Psychic"  class="dmg-perc-50">½</td>
                    <td id="Psychic → Bug"      class="dmg-perc-"></td>
                    <td id="Psychic → Rock"     class="dmg-perc-"></td>
                    <td id="Psychic → Ghost"    class="dmg-perc-"></td>
                    <td id="Psychic → Dragon"   class="dmg-perc-"></td>
                    <td id="Psychic → Dark"     class="dmg-perc-0">0</td>
                    <td id="Psychic → Steel"    class="dmg-perc-50">½</td>
                    <td id="Psychic → Fairy"    class="dmg-perc-"></td>
                </tr>
                <tr id="Bug">
                    <th>
                        <a class="icon-fu type-bug">Bug</a>
                    </th>
                    <td id="Bug → Normal"   class="dmg-perc-"></td>
                    <td id="Bug → Fire"     class="dmg-perc-50">½</td>
                    <td id="Bug → Water"    class="dmg-perc-"></td>
                    <td id="Bug → Electric" class="dmg-perc-"></td>
                    <td id="Bug → Grass"    class="dmg-perc-200">2</td>
                    <td id="Bug → Ice"      class="dmg-perc-"></td>
                    <td id="Bug → Fighting" class="dmg-perc-50">½</td>
                    <td id="Bug → Poison"   class="dmg-perc-50">½</td>
                    <td id="Bug → Ground"   class="dmg-perc-"></td>
                    <td id="Bug → Flying"   class="dmg-perc-50">½</td>
                    <td id="Bug → Psychic"  class="dmg-perc-200">2</td>
                    <td id="Bug → Bug"      class="dmg-perc-"></td>
                    <td id="Bug → Rock"     class="dmg-perc-"></td>
                    <td id="Bug → Ghost"    class="dmg-perc-50">½</td>
                    <td id="Bug → Dragon"   class="dmg-perc-"></td>
                    <td id="Bug → Dark"     class="dmg-perc-200">2</td>
                    <td id="Bug → Steel"    class="dmg-perc-50">½</td>
                    <td id="Bug → Fairy"    class="dmg-perc-50">½</td>
                </tr>
                <tr id="Rock">
                    <th>
                        <a class="icon-fu type-rock">Rock</a>
                    </th>
                    <td id="Rock → Normal"   class="dmg-perc-"></td>
                    <td id="Rock → Fire"     class="dmg-perc-200">2</td>
                    <td id="Rock → Water"    class="dmg-perc-"></td>
                    <td id="Rock → Electric" class="dmg-perc-"></td>
                    <td id="Rock → Grass"    class="dmg-perc-"></td>
                    <td id="Rock → Ice"      class="dmg-perc-200">2</td>
                    <td id="Rock → Fighting" class="dmg-perc-50">½</td>
                    <td id="Rock → Poison"   class="dmg-perc-"></td>
                    <td id="Rock → Ground"   class="dmg-perc-50">½</td>
                    <td id="Rock → Flying"   class="dmg-perc-200">2</td>
                    <td id="Rock → Psychic"  class="dmg-perc-"></td>
                    <td id="Rock → Bug"      class="dmg-perc-200">2</td>
                    <td id="Rock → Rock"     class="dmg-perc-"></td>
                    <td id="Rock → Ghost"    class="dmg-perc-"></td>
                    <td id="Rock → Dragon"   class="dmg-perc-"></td>
                    <td id="Rock → Dark"     class="dmg-perc-"></td>
                    <td id="Rock → Steel"    class="dmg-perc-50">½</td>
                    <td id="Rock → Fairy"    class="dmg-perc-"></td>
                </tr>
                <tr id="Ghost">
                    <th>
                        <a class="icon-fu type-ghost">Ghost</a>
                    </th>
                    <td id="Ghost → Normal"   class="dmg-perc-0">0</td>
                    <td id="Ghost → Fire"     class="dmg-perc-"></td>
                    <td id="Ghost → Water"    class="dmg-perc-"></td>
                    <td id="Ghost → Electric" class="dmg-perc-"></td>
                    <td id="Ghost → Grass"    class="dmg-perc-"></td>
                    <td id="Ghost → Ice"      class="dmg-perc-"></td>
                    <td id="Ghost → Fighting" class="dmg-perc-"></td>
                    <td id="Ghost → Poison"   class="dmg-perc-"></td>
                    <td id="Ghost → Ground"   class="dmg-perc-"></td>
                    <td id="Ghost → Flying"   class="dmg-perc-"></td>
                    <td id="Ghost → Psychic"  class="dmg-perc-200">2</td>
                    <td id="Ghost → Bug"      class="dmg-perc-"></td>
                    <td id="Ghost → Rock"     class="dmg-perc-"></td>
                    <td id="Ghost → Ghost"    class="dmg-perc-200">2</td>
                    <td id="Ghost → Dragon"   class="dmg-perc-"></td>
                    <td id="Ghost → Dark"     class="dmg-perc-50">½</td>
                    <td id="Ghost → Steel"    class="dmg-perc-"></td>
                    <td id="Ghost → Fairy"    class="dmg-perc-"></td>
                </tr>
                <tr id="Dragon">
                    <th>
                        <a class="icon-fu type-dragon">Dragon</a>
                    </th>
                    <td id="Dragon → Normal"   class="dmg-perc-"></td>
                    <td id="Dragon → Fire"     class="dmg-perc-"></td>
                    <td id="Dragon → Water"    class="dmg-perc-"></td>
                    <td id="Dragon → Electric" class="dmg-perc-"></td>
                    <td id="Dragon → Grass"    class="dmg-perc-"></td>
                    <td id="Dragon → Ice"      class="dmg-perc-"></td>
                    <td id="Dragon → Fighting" class="dmg-perc-"></td>
                    <td id="Dragon → Poison"   class="dmg-perc-"></td>
                    <td id="Dragon → Ground"   class="dmg-perc-"></td>
                    <td id="Dragon → Flying"   class="dmg-perc-"></td>
                    <td id="Dragon → Psychic"  class="dmg-perc-"></td>
                    <td id="Dragon → Bug"      class="dmg-perc-"></td>
                    <td id="Dragon → Rock"     class="dmg-perc-"></td>
                    <td id="Dragon → Ghost"    class="dmg-perc-"></td>
                    <td id="Dragon → Dragon"   class="dmg-perc-200">2</td>
                    <td id="Dragon → Dark"     class="dmg-perc-"></td>
                    <td id="Dragon → Steel"    class="dmg-perc-50">½</td>
                    <td id="Dragon → Fairy"    class="dmg-perc-0">0</td>
                </tr>
                <tr id="Dark">
                    <th>
                        <a class="icon-fu type-dark">Dark</a>
                    </th>
                    <td id="Dark → Normal"   class="dmg-perc-"></td>
                    <td id="Dark → Fire"     class="dmg-perc-"></td>
                    <td id="Dark → Water"    class="dmg-perc-"></td>
                    <td id="Dark → Electric" class="dmg-perc-"></td>
                    <td id="Dark → Grass"    class="dmg-perc-"></td>
                    <td id="Dark → Ice"      class="dmg-perc-"></td>
                    <td id="Dark → Fighting" class="dmg-perc-50">½</td>
                    <td id="Dark → Poison"   class="dmg-perc-"></td>
                    <td id="Dark → Ground"   class="dmg-perc-"></td>
                    <td id="Dark → Flying"   class="dmg-perc-"></td>
                    <td id="Dark → Psychic"  class="dmg-perc-200">2</td>
                    <td id="Dark → Bug"      class="dmg-perc-"></td>
                    <td id="Dark → Rock"     class="dmg-perc-"></td>
                    <td id="Dark → Ghost"    class="dmg-perc-200">2</td>
                    <td id="Dark → Dragon"   class="dmg-perc-"></td>
                    <td id="Dark → Dark"     class="dmg-perc-50">½</td>
                    <td id="Dark → Steel"    class="dmg-perc-"></td>
                    <td id="Dark → Fairy"    class="dmg-perc-50">½</td>
                </tr>
                <tr id="Steel">
                    <th>
                        <a class="icon-fu type-steel">Steel</a>
                    </th>
                    <td id="Steel → Normal"   class="dmg-perc-"></td>
                    <td id="Steel → Fire"     class="dmg-perc-50">½</td>
                    <td id="Steel → Water"    class="dmg-perc-50">½</td>
                    <td id="Steel → Electric" class="dmg-perc-50">½</td>
                    <td id="Steel → Grass"    class="dmg-perc-"></td>
                    <td id="Steel → Ice"      class="dmg-perc-200">2</td>
                    <td id="Steel → Fighting" class="dmg-perc-"></td>
                    <td id="Steel → Poison"   class="dmg-perc-"></td>
                    <td id="Steel → Ground"   class="dmg-perc-"></td>
                    <td id="Steel → Flying"   class="dmg-perc-"></td>
                    <td id="Steel → Psychic"  class="dmg-perc-"></td>
                    <td id="Steel → Bug"      class="dmg-perc-"></td>
                    <td id="Steel → Rock"     class="dmg-perc-200">2</td>
                    <td id="Steel → Ghost"    class="dmg-perc-"></td>
                    <td id="Steel → Dragon"   class="dmg-perc-"></td>
                    <td id="Steel → Dark"     class="dmg-perc-"></td>
                    <td id="Steel → Steel"    class="dmg-perc-50">½</td>
                    <td id="Steel → Fairy"    class="dmg-perc-200">2</td>
                </tr>
                <tr id="Fairy">
                    <th>
                        <a class="icon-fu type-fairy">Fairy</a>
                    </th>
                    <td id="Fairy → Normal"   class="dmg-perc-"></td>
                    <td id="Fairy → Fire"     class="dmg-perc-50">½</td>
                    <td id="Fairy → Water"    class="dmg-perc-"></td>
                    <td id="Fairy → Electric" class="dmg-perc-"></td>
                    <td id="Fairy → Grass"    class="dmg-perc-"></td>
                    <td id="Fairy → Ice"      class="dmg-perc-"></td>
                    <td id="Fairy → Fighting" class="dmg-perc-200">2</td>
                    <td id="Fairy → Poison"   class="dmg-perc-50">½</td>
                    <td id="Fairy → Ground"   class="dmg-perc-"></td>
                    <td id="Fairy → Flying"   class="dmg-perc-"></td>
                    <td id="Fairy → Psychic"  class="dmg-perc-"></td>
                    <td id="Fairy → Bug"      class="dmg-perc-"></td>
                    <td id="Fairy → Rock"     class="dmg-perc-"></td>
                    <td id="Fairy → Ghost"    class="dmg-perc-"></td>
                    <td id="Fairy → Dragon"   class="dmg-perc-200">2</td>
                    <td id="Fairy → Dark"     class="dmg-perc-200">2</td>
                    <td id="Fairy → Steel"    class="dmg-perc-50">½</td>
                    <td id="Fairy → Fairy"    class="dmg-perc-"></td>
                </tr>
            </tbody>
        </table>

        <label id="changes-label" title="To the official type chart">Changes: 
            <span id="changes-show">0</span>
        </label>

        <table id="stats-table">
            <thead>
                <tr id="stats-head">
                    <th class="tiny-text">TYPE&nbsp;&#8594;<br/>STAT&nbsp;&#8628;</th>
                    <th>
                        <a class="icon-fu type-normal">Normal</a>
                    </th>
                    <th>
                        <a class="icon-fu type-fire">Fire</a>
                    </th>
                    <th>
                        <a class="icon-fu type-water">Water</a>
                    </th>
                    <th>
                        <a class="icon-fu type-electric">Electric</a>
                    </th>
                    <th>
                        <a class="icon-fu type-grass">Grass</a>
                    </th>
                    <th>
                        <a class="icon-fu type-ice">Ice</a>
                    </th>
                    <th>
                        <a class="icon-fu type-fighting">Fighting</a>
                    </th>
                    <th>
                        <a class="icon-fu type-poison">Poison</a>
                    </th>
                    <th>
                        <a class="icon-fu type-ground">Ground</a>
                    </th>
                    <th>
                        <a class="icon-fu type-flying">Flying</a>
                    </th>
                    <th>
                        <a class="icon-fu type-psychic">Psychic</a>
                    </th>
                    <th>
                        <a class="icon-fu type-bug">Bug</a>
                    </th>
                    <th>
                        <a class="icon-fu type-rock">Rock</a>
                    </th>
                    <th>
                        <a class="icon-fu type-ghost">Ghost</a>
                    </th>
                    <th>
                        <a class="icon-fu type-dragon">Dragon</a>
                    </th>
                    <th>
                        <a class="icon-fu type-dark">Dark</a>
                    </th>
                    <th>
                        <a class="icon-fu type-steel">Steel</a>
                    </th>
                    <th>
                        <a class="icon-fu type-fairy">Fairy</a>
                    </th>

                    <th>
                        <a class="icon-fu type-dragon" title="Lower is better">STD DEV</a>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr id="stats-ATK">
                    <th><a class="icon-fu type-ice">ATTACK</a></th>

                    <td id="ATK Normal"   class="dmg-perc-50">-4</td>
                    <td id="ATK Fire"     class="dmg-perc-N">0</td>
                    <td id="ATK Water"    class="dmg-perc-N">0</td>
                    <td id="ATK Electric" class="dmg-perc-50">-3</td>
                    <td id="ATK Grass"    class="dmg-perc-50">-4</td>
                    <td id="ATK Ice"      class="dmg-perc-N">0</td>
                    <td id="ATK Fighting" class="dmg-perc-50">-2</td>
                    <td id="ATK Poison"   class="dmg-perc-50">-4</td>
                    <td id="ATK Ground"   class="dmg-perc-200">1</td>
                    <td id="ATK Flying"   class="dmg-perc-N">0</td>
                    <td id="ATK Psychic"  class="dmg-perc-50">-2</td>
                    <td id="ATK Bug"      class="dmg-perc-50">-4</td>
                    <td id="ATK Rock"     class="dmg-perc-200">1</td>
                    <td id="ATK Ghost"    class="dmg-perc-50">-1</td>
                    <td id="ATK Dragon"   class="dmg-perc-50">-2</td>
                    <td id="ATK Dark"     class="dmg-perc-50">-1</td>
                    <td id="ATK Steel"    class="dmg-perc-50">-1</td>
                    <td id="ATK Fairy"    class="dmg-perc-N">0</td>
                    <td id="ATK STD"      class="dmg-perc-">1.71</td>
                </tr>
                <tr id="stats-DEF">
                    <th><a class="icon-fu type-steel">DEFENCE</a></th>

                    <td id="DEF Normal"   class="dmg-perc-200">1</td>
                    <td id="DEF Fire"     class="dmg-perc-200">3</td>
                    <td id="DEF Water"    class="dmg-perc-200">2</td>
                    <td id="DEF Electric" class="dmg-perc-200">2</td>
                    <td id="DEF Grass"    class="dmg-perc-50">-1</td>
                    <td id="DEF Ice"      class="dmg-perc-50">-3</td>
                    <td id="DEF Fighting" class="dmg-perc-N">0</td>
                    <td id="DEF Poison"   class="dmg-perc-200">3</td>
                    <td id="DEF Ground"   class="dmg-perc-200">1</td>
                    <td id="DEF Flying"   class="dmg-perc-200">2</td>
                    <td id="DEF Psychic"  class="dmg-perc-50">-1</td>
                    <td id="DEF Bug"      class="dmg-perc-N">0</td>
                    <td id="DEF Rock"     class="dmg-perc-50">-1</td>
                    <td id="DEF Ghost"    class="dmg-perc-200">4</td>
                    <td id="DEF Dragon"   class="dmg-perc-200">1</td>
                    <td id="DEF Dark"     class="dmg-perc-200">1</td>
                    <td id="DEF Steel"    class="dmg-perc-200">9</td>
                    <td id="DEF Fairy"    class="dmg-perc-200">3</td>
                    <td id="DEF STD"      class="dmg-perc-">2.52</td>
                </tr>
                <tr id="stats-total">
                    <th><a class="icon-fu type-fire">TOTAL</a></th>
                    <td id="Total Normal"   class="dmg-perc-50">-3</td>
                    <td id="Total Fire"     class="dmg-perc-200">3</td>
                    <td id="Total Water"    class="dmg-perc-200">2</td>
                    <td id="Total Electric" class="dmg-perc-50">-1</td>
                    <td id="Total Grass"    class="dmg-perc-50">-5</td>
                    <td id="Total Ice"      class="dmg-perc-50">-3</td>
                    <td id="Total Fighting" class="dmg-perc-50">-2</td>
                    <td id="Total Poison"   class="dmg-perc-50">-1</td>
                    <td id="Total Ground"   class="dmg-perc-200">2</td>
                    <td id="Total Flying"   class="dmg-perc-200">2</td>
                    <td id="Total Psychic"  class="dmg-perc-50">-3</td>
                    <td id="Total Bug"      class="dmg-perc-50">-4</td>
                    <td id="Total Rock"     class="dmg-perc-N">0</td>
                    <td id="Total Ghost"    class="dmg-perc-200">3</td>
                    <td id="Total Dragon"   class="dmg-perc-50">-1</td>
                    <td id="Total Dark"     class="dmg-perc-N">0</td>
                    <td id="Total Steel"    class="dmg-perc-200">8</td>
                    <td id="Total Fairy"    class="dmg-perc-200">3</td>
                    <td id="Total STD"      class="dmg-perc-">3.14</td>
                </tr>
            </tbody>
        </table>
        <script>
        // Official chart used to track how well yours preserves it
        // Aim to minimize type imbalances, while preserving original relations
        const original = [
            "","","","","","","","","","","","","½","0","","","½","",
            "","½","½","","2","2","","","","","","2","½","","½","","2","",
            "","2","½","","½","","","","2","","","","2","","½","","","",
            "","","2","½","½","","","","0","2","","","","","½","","","",
            "","½","2","","½","","","½","2","½","","½","2","","½","","½","",
            "","½","½","","2","½","","","2","2","","","","","2","","½","",
            "2","","","","","2","","½","","½","½","½","2","0","","2","2","½",
            "","","","","2","","","½","½","","","","½","½","","","0","2",
            "","2","","2","½","","","2","","0","","½","2","","","", "2","",
            "","","","½","2","","2","","","","","2","½","","","","½","",
            "","","","","","","2","2","","","½","","","","","0","½","",
            "","½","","","2","","½","½","","½","2","","","½","","2","½","½",
            "","2","","","","2","½","","½","2","","2","","","","","½","",
            "0","","","","","","","","","","2","","","2","","½","","",
            "","","","","","","","","","","","","","","2","","½","0",
            "","","","","","","½","","","","2","","","2","","½","","½",
            "","½","½","½","","2","","","","","","","2","","","","½","2",
            "","½","","","","","2","½","","","","","","","2","2","½",""];

        const types = [ "Normal", "Fire", "Water", "Electric", "Grass", "Ice",
                      "Fighting", "Poison", "Ground", "Flying", "Psychic", "Bug",
                      "Rock", "Ghost", "Dragon", "Dark", "Steel", "Fairy"];

        window.addEventListener("DOMContentLoaded", () => {

            // Get <tr>'s. Chart is 18 x 18 table showing each ATK → DEF effective dmg
            const chartHead = document.getElementById("chart-head");
            const chartBody = document.getElementById("chart-body");

            const statsHead  = document.getElementById("stats-head");
            const statsATK   = document.getElementById("stats-ATK");
            const statsDEF   = document.getElementById("stats-DEF");
            const statsTotal = document.getElementById("stats-total");

            const changesShow = document.getElementById("changes-show");

            // For types: "Ice", "Rock", etc, collect <tr id="Ice">, <tr id="Rock">, etc
            let bodyRows = types.map(id => document.getElementById(id));

            let statsBody = types.map(name => ({
                ATK: document.getElementById("ATK " + name),
                DEF: document.getElementById("DEF " + name),
                Total  : document.getElementById("Total " + name)
            }));

            const nCells = types.length * types.length;
            const cells = new Array(nCells);

            enableCells();
            addRowClear();
            enableButtons();
            // ---------------------------------------------------------

            // addListener to each <td id="[ATK type] → [DEF type]">
            // Store all 18 x 18 in cells along 1D
            function enableCells() {
                for (let iATK = 0; iATK < 18; iATK++) {
                    for (let iDEF = 0; iDEF < 18; iDEF++) {
                        let id = types[iATK] + " → " + types[iDEF];

                        cells[(18 * iATK) + iDEF] = document.getElementById(id);
                        addListener(iATK, iDEF);
                    }
                } 
            }

            // Pass iATK, iDEF so cell knows to updateStats for those types
            // On click, 1. Cycle to next dmg % : 0 → 50 → 100 → 200
            //           2. updateStats of affected (ie ATK, DEF) types
            function addListener(iATK, iDEF) {

                let index = (18 * iATK) + iDEF;
                let cell  = cells[index];

                cell.addEventListener("click", () => {
                    let prevDiff = isChanged(index);

                    switch (cell.textContent) {
                        case "0":
                            cell.textContent = "½";         // Resisted
                            break;

                        case "½":
                            cell.textContent = "";
                            break;

                        case "":
                            cell.textContent = "2";         // Super effective
                            break;

                        case "2":
                            cell.textContent = "0";         // Immune (no damage)
                    }
                    setClassName(cell);
                    updateStats(iATK, iDEF);
                    updateSTD();
                    changesShow.textContent = +changesShow.textContent - prevDiff + isChanged(index);
                });
            }

            // Cell click uses both iATK, iDEF. Row clear uses only iDEF
            function updateStats(iATK = null, iDEF = null) {

                // Loop thru row of ATK type and add numeric equiv for
                // its effective dmg against each DEF type

                let sumATK = 0;
                if (iATK !== null) {
                    let iCell  = 18 * iATK;
                    for (let i = 0; i < 18; i++, iCell++) {
                        sumATK = sumATK + getFXness(cells[iCell]);
                    }

                    setStat(statsBody[iATK].ATK, sumATK);
                }

                let sumDEF = 0;
                if (iDEF !== null) {
                    for (let iCell = iDEF; iCell < nCells; iCell += 18) {
                        // Drawback to ATK type is benefit to DEF type 
                        sumDEF = sumDEF - getFXness(cells[iCell]);
                    }

                    setStat(statsBody[iDEF].DEF, sumDEF);
                }

                // Update total(s) of affected type(s) as sum of its stats
                if (iATK !== null) {
                    setStat(statsBody[iATK].Total,
                            sumATK + +statsBody[iATK].DEF.textContent);
                }
                if (iDEF !== null) {
                    setStat(statsBody[iDEF].Total,
                            +statsBody[iDEF].ATK.textContent + sumDEF);
                }
            }

            // Called on cell change to update value and assigned color
            function setStat(stat, value) {
                stat.textContent = value;
                stat.className   = value > 0 ? "dmg-perc-200" :
                                   value < 0 ? "dmg-perc-50"  :
                                               "dmg-perc-N";
            }

            function isChanged(index) {
                return cells[index].textContent !== original[index];
            }

            // Align cell's style (ie backgroundColor) with its value
            function setClassName(cell) {
                switch (cell.textContent) {
                    case "0":        
                        cell.className = "dmg-perc-0";
                        break;

                    case "½":
                        cell.className = "dmg-perc-50";
                        break;

                    case "":
                        cell.className = "dmg-perc-";
                        break;

                    case "2":
                        cell.className = "dmg-perc-200";
                }
            }

            // Assign numeric value to ATK type's effective damage
            function getFXness(cell) {
                switch (cell.textContent) {
                    case "0": return -2;
                    case "½": return -1;
                    case "":  return 0;
                    case "2": return 1;
                }
            }

            // To each icon, add tip and dbclick listener that zeroes-out row
            function addRowClear() {
                for (let iATK = 0; iATK < 18; iATK++) {
                    let tr = bodyRows[iATK];

                    let th = tr.querySelector('th');
                    th.title = "Double-click to clear row";
                    
                    th.addEventListener('dblclick', () => {
                        let tds = tr.querySelectorAll('td');
                        let start = 18 * iATK;

                        let nDiff = +changesShow.textContent;
                        for (let iDEF = 0; iDEF < 18; iDEF++) {
                            let prevDiff = isChanged(start + iDEF);

                            let td = tds[iDEF];
                            td.className = "dmg-perc-";
                            td.textContent = "";

                            updateStats(null, iDEF);
                            setStat(statsBody[iATK].ATK, 0);
                            nDiff = nDiff - prevDiff + isChanged(start + iDEF);
                        }
                        updateSTD();
                        changesShow.textContent = nDiff;
                    });
                }
            }

            // Calc, show new STD values. Called when cell or row's icon is clicked
            function updateSTD() {

                let stdElem = document.getElementById("ATK STD");
                let values = [];
                statsBody.forEach(statGrp => {
                    values.push(+statGrp.ATK.textContent);
                });
                stdElem.textContent = STD(values).toFixed(2);

                stdElem = document.getElementById("DEF STD");
                values = [];
                statsBody.forEach(statGrp => {
                    values.push(+statGrp.DEF.textContent);
                });
                stdElem.textContent = STD(values).toFixed(2);

                stdElem = document.getElementById("Total STD");
                values = [];
                statsBody.forEach(statGrp => {
                    values.push(+statGrp.Total.textContent);
                });
                stdElem.textContent = STD(values).toFixed(2);
            }

            // Calc std deviation as measure of balance between types
            function STD(array) {   
                const n = array.length;
                if (n === 0) return 0;

                const mean = array.reduce((acc, val) => acc + val, 0) / n;
                const variance = array.reduce((acc, val) => acc + (val - mean) ** 2, 0) / n;
                return Math.sqrt(variance);
            }

            // Add function to handle each task. fileUpload listens for change
            function enableButtons() {
                let fileUpload = document.getElementById('file-upload');
                fileUpload.addEventListener('change', handleUpload);
                let btnUpload = document.getElementById('btn-upload');
                btnUpload.addEventListener('click', () => fileUpload.click());

                document.getElementById('btn-clear').addEventListener('click', clearAll);
                document.getElementById('btn-download').addEventListener('click', download);
            }

            function handleUpload(event) {
                const file = event.target.files[0];
                if (!file) return;
                const reader = new FileReader();

                reader.onload = function(e) {
                    const content = e.target.result;
                    const lines = content.split('\n').slice(2);
                    const data = lines.map(line => line.split(','));

                    // Paste each value in file onto matching cell
                    let i = 0, nDiff = 0;
                    for (let row = 0; row < 18; row++) {
                        for (let col = 0; col < 18; col++, i++) {
                            cells[i].textContent = data[row][col];
                            setClassName(cells[i]);

                            nDiff += isChanged(i);
                        }
                    }

                    // Sum row, then col of each type. Calc std dev
                    for (i = 0; i < 18; i++) {
                        updateStats(i, null);
                        updateStats(null, i);
                    }
                    updateSTD();
                    changesShow.textContent = nDiff;
                };

                reader.readAsText(file);
            }

            function clearAll() {
                cells.forEach(cell => {
                    cell.className = "dmg-perc-";
                    cell.textContent = "";
                });

                statsBody.forEach(statGrp => {
                    setStat(statGrp.ATK  , 0);
                    setStat(statGrp.DEF  , 0);
                    setStat(statGrp.Total, 0);
                });

                document.querySelector('#stats-table')
                        .querySelectorAll('[id$="STD"]')
                        .forEach(std => {
                            std.textContent = 0;
                        });

                changesShow.textContent = 120; // Precalculated
            }

            // Save progress as .csv. Upload saved file to restore chart
            function download() {
                let now = (new Date()).toLocaleString();
                let content = `Pokémon Type Rebalancing — ${now}\n\n`;

                // 18 lines of 18 comma-separated-values
                let i = 0;
                for (let row = 0; row < 18; row++) {
                    let line = [];
                    for (let col = 0; col < 18; col++, i++) {
                        line.push(cells[i].textContent);
                    }
                    content += line.join(',') + '\n';
                }

                let blob = new Blob([content], { type: 'text/csv; charset=utf-8;' });
                
                // Firefox requires clicked link to be added to document
                let link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = "typechart.csv";

                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        });
        </script>
    </body>
</html>